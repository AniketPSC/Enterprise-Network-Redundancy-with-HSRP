! L3SW-1 (Primary L3 switch; DHCP server; HSRP Active)
hostname L3SW-1
no ip domain-lookup
ip routing

! VLANs
vlan 10
 name HR
vlan 20
 name Finance
vlan 30
 name IT
exit

! Trunk to access
interface Gi0/1
 switchport mode trunk
 switchport trunk allowed vlan 10,20,30
 no shutdown
exit

! Routed link to R-HQ
interface Gi0/2
 no switchport
 ip address 10.0.0.2 255.255.255.252
 no shutdown
exit

! SVIs + HSRP
interface Vlan10
 ip address 10.0.10.2 255.255.255.0
 standby 10 ip 10.0.10.1
 standby 10 priority 110
 standby 10 preempt
 no shutdown
exit

interface Vlan20
 ip address 10.0.20.2 255.255.255.0
 standby 20 ip 10.0.20.1
 standby 20 priority 110
 standby 20 preempt
 no shutdown
exit

interface Vlan30
 ip address 10.0.30.2 255.255.255.0
 standby 30 ip 10.0.30.1
 standby 30 priority 110
 standby 30 preempt
 no shutdown
exit

! Loopback used as stable DHCP target for ip helper
interface Loopback0
 ip address 10.255.255.1 255.255.255.255
exit

! DHCP pools (centralized)
ip dhcp excluded-address 10.0.10.1 10.0.10.20
ip dhcp excluded-address 10.0.20.1 10.0.20.20
ip dhcp excluded-address 10.0.30.1 10.0.30.20
ip dhcp excluded-address 10.1.10.1 10.1.10.20
ip dhcp excluded-address 10.2.10.1 10.2.10.20

ip dhcp pool VLAN10-HR
 network 10.0.10.0 255.255.255.0
 default-router 10.0.10.1
 dns-server 8.8.8.8
exit

ip dhcp pool VLAN20-FIN
 network 10.0.20.0 255.255.255.0
 default-router 10.0.20.1
 dns-server 8.8.8.8
exit

ip dhcp pool VLAN30-IT
 network 10.0.30.0 255.255.255.0
 default-router 10.0.30.1
 dns-server 8.8.8.8
exit

ip dhcp pool BR1-LAN
 network 10.1.10.0 255.255.255.0
 default-router 10.1.10.1
 dns-server 8.8.8.8
exit

ip dhcp pool BR2-LAN
 network 10.2.10.0 255.255.255.0
 default-router 10.2.10.1
 dns-server 8.8.8.8
exit

! OSPF
router ospf 1
 router-id 1.1.1.1
 network 10.0.0.0 0.0.0.3 area 0
 network 10.0.10.0 0.0.0.255 area 0
 network 10.0.20.0 0.0.0.255 area 0
 network 10.0.30.0 0.0.0.255 area 0
 network 10.255.255.1 0.0.0.0 area 0
exit

! ACL: block HR -> IT
ip access-list extended HR_TO_IT_BLOCK
 deny ip 10.0.10.0 0.0.0.255 10.0.30.0 0.0.0.255
 permit ip any any
exit
interface Vlan10
 ip access-group HR_TO_IT_BLOCK in
exit

! Save
write memory
